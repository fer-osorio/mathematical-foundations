<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'">
    <title>Hash Function Visualizer - Cryptography Portfolio</title>

    <!-- Link to stylesheets -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/pages/hash-tool.css">

    <!-- Load CryptoJS from CDN (for MD5 and SHA-3) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <h1 class="logo">Hash Function Visualizer</h1>
                <ul class="nav-links">
                    <li><a href="../index.html">‚Üê Back to Portfolio</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="hash-tool-container">
        <!-- Error display -->
        <div id="error-message" class="alert alert--error" hidden></div>

        <!-- Tabbed interface -->
        <div class="tabs">
            <button class="tab-button active" data-tab="hash-computation">1. Hash Computation</button>
            <button class="tab-button" data-tab="avalanche-effect">2. Avalanche Effect</button>
            <button class="tab-button" data-tab="collision-resistance">3. Collision Resistance</button>
            <button class="tab-button" data-tab="security-analysis">4. Security Analysis</button>
        </div>

        <!-- Tab 1: Hash Computation -->
        <div id="hash-computation" class="tab-panel active">
            <h2>Hash Computation</h2>
            <p>Compute cryptographic hashes using different algorithms.</p>

            <div class="card card--control form-group">
                <label for="hash-input">Enter text to hash:</label>
                <textarea id="hash-input" placeholder="Type your message here...">Hello, World!</textarea>
            </div>

            <div class="card card--control form-group">
                <label>Select hash algorithms:</label>
                <div class="form-option-grid">
                    <div class="form-option">
                        <input type="checkbox" id="algo-md5" name="hash-algorithm" value="md5">
                        <label for="algo-md5">
                            MD5 <span class="security-badge broken">BROKEN</span>
                        </label>
                    </div>
                    <div class="form-option">
                        <input type="checkbox" id="algo-sha1" name="hash-algorithm" value="sha1">
                        <label for="algo-sha1">
                            SHA-1 <span class="security-badge deprecated">DEPRECATED</span>
                        </label>
                    </div>
                    <div class="form-option">
                        <input type="checkbox" id="algo-sha256" name="hash-algorithm" value="sha256" checked>
                        <label for="algo-sha256">
                            SHA-256 <span class="security-badge secure">SECURE</span>
                        </label>
                    </div>
                    <div class="form-option">
                        <input type="checkbox" id="algo-sha512" name="hash-algorithm" value="sha512">
                        <label for="algo-sha512">
                            SHA-512 <span class="security-badge secure">SECURE</span>
                        </label>
                    </div>
                    <div class="form-option">
                        <input type="checkbox" id="algo-sha3" name="hash-algorithm" value="sha3-256">
                        <label for="algo-sha3">
                            SHA3-256 <span class="security-badge secure">SECURE</span>
                        </label>
                    </div>
                </div>
            </div>

            <button id="compute-hash-btn" class="btn btn-primary">Compute Hashes</button>

            <div id="hash-results"></div>
        </div>

        <!-- Tab 2: Avalanche Effect -->
        <div id="avalanche-effect" class="tab-panel">
            <h2>Avalanche Effect Demonstration</h2>
            <p>See how changing one character affects the entire hash output.</p>

            <div class="card card--control form-group">
                <label for="avalanche-input">Enter base text:</label>
                <textarea id="avalanche-input" placeholder="Type your message here...">Hello, World!</textarea>
            </div>

            <div class="card card--control form-group">
                <label for="avalanche-algorithm">Select algorithm:</label>
                <select id="avalanche-algorithm">
                    <option value="md5">MD5</option>
                    <option value="sha1">SHA-1</option>
                    <option value="sha256" selected>SHA-256</option>
                    <option value="sha512">SHA-512</option>
                    <option value="sha3-256">SHA3-256</option>
                </select>
            </div>

            <button id="avalanche-btn" class="btn btn-primary">Test Avalanche Effect</button>

            <div id="avalanche-results"></div>

            <div class="card card--control" style="margin-top: 2rem;">
                <h3>What is the Avalanche Effect?</h3>
                <p>
                    A good cryptographic hash function should exhibit the <strong>avalanche effect</strong>:
                    changing even a single bit of input should change approximately 50% of the output bits.
                </p>
                <p>
                    This property ensures that similar inputs produce completely different hash values,
                    making it impossible to predict or correlate outputs based on inputs.
                </p>
            </div>
        </div>

        <!-- Tab 3: Collision Resistance -->
        <div id="collision-resistance" class="tab-panel">
            <h2>Birthday Attack & Collision Probability</h2>
            <p>Calculate the probability of finding hash collisions.</p>

            <div class="card card--control form-group">
                <label for="birthday-algorithm">Select algorithm:</label>
                <select id="birthday-algorithm">
                    <option value="md5">MD5 (128-bit)</option>
                    <option value="sha1">SHA-1 (160-bit)</option>
                    <option value="sha256" selected>SHA-256 (256-bit)</option>
                    <option value="sha512">SHA-512 (512-bit)</option>
                    <option value="sha3-256">SHA3-256 (256-bit)</option>
                </select>
            </div>

            <button id="birthday-calc-btn" class="btn btn-primary">Calculate Collision Probability</button>

            <div id="birthday-results"></div>
        </div>

        <!-- Tab 4: Security Analysis -->
        <div id="security-analysis" class="tab-panel">
            <h2>Security Analysis & Best Practices</h2>

            <div class="card card--control">
                <h3>üîê Hash Function Security Properties</h3>
                <ul>
                    <li><strong>Preimage Resistance:</strong> Given hash h, finding message m where H(m) = h is computationally infeasible</li>
                    <li><strong>Second Preimage Resistance:</strong> Given message m‚ÇÅ, finding different m‚ÇÇ where H(m‚ÇÅ) = H(m‚ÇÇ) is infeasible</li>
                    <li><strong>Collision Resistance:</strong> Finding any two different messages with the same hash is infeasible</li>
                    <li><strong>Avalanche Effect:</strong> Small input changes cause large output changes (~50% bits flip)</li>
                </ul>
            </div>

            <div class="card card--control">
                <h3>‚õî Broken Hash Functions</h3>
                <h4>MD5 (1991-2008)</h4>
                <p><strong>Status:</strong> Completely broken - practical collision attacks</p>
                <p><strong>Attack:</strong> Collisions can be found in seconds on a laptop</p>
                <p><strong>Impact:</strong> Used in Flame malware (2012) to forge certificates</p>
                <p><strong>Current Use:</strong> Non-cryptographic checksums only</p>

                <h4>SHA-1 (1995-2017)</h4>
                <p><strong>Status:</strong> Deprecated - practical collision demonstrated</p>
                <p><strong>Attack:</strong> Google's SHAttered (2017) - $110,000 compute cost</p>
                <p><strong>Impact:</strong> Browsers now reject SHA-1 certificates</p>
                <p><strong>Current Use:</strong> Legacy systems transitioning away</p>
            </div>

            <div class="card card--control">
                <h3>‚úÖ Secure Hash Functions</h3>
                <h4>SHA-256 (2001-Present)</h4>
                <p><strong>Status:</strong> Secure - no known practical attacks</p>
                <p><strong>Usage:</strong> Bitcoin, TLS, digital signatures, Git</p>
                <p><strong>Security:</strong> 2^256 preimage, 2^128 collision resistance</p>

                <h4>SHA-3 / Keccak (2015-Present)</h4>
                <p><strong>Status:</strong> Secure - different construction than SHA-2</p>
                <p><strong>Advantage:</strong> Sponge construction, immune to length extension</p>
                <p><strong>Usage:</strong> Ethereum, post-quantum signatures</p>
            </div>

            <div class="card card--control">
                <h3>üéØ Best Practices</h3>
                <ul>
                    <li><strong>For general use:</strong> SHA-256 or SHA-3</li>
                    <li><strong>For passwords:</strong> Use Argon2, bcrypt, or PBKDF2 (NOT plain hashes)</li>
                    <li><strong>For message authentication:</strong> Use HMAC with SHA-256+</li>
                    <li><strong>For digital signatures:</strong> SHA-256 or SHA-512</li>
                    <li><strong>Avoid:</strong> MD5, SHA-1, custom hash functions</li>
                </ul>
            </div>

            <div class="card card--control">
                <h3>‚ö†Ô∏è Common Mistakes</h3>
                <ul>
                    <li><strong>Password storage:</strong> Never use plain hashes - use password-specific functions</li>
                    <li><strong>Message authentication:</strong> Don't use H(key || message) - use HMAC</li>
                    <li><strong>Checksums:</strong> Don't use cryptographic hashes for integrity - use CRC or BLAKE2</li>
                    <li><strong>Comparison:</strong> Use constant-time comparison to prevent timing attacks</li>
                </ul>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Cryptography Portfolio. Educational demonstration only.</p>
    </footer>

    <!-- Load scripts in order -->
    <script src="../js/crypto-demos/hash-utils.js"></script>
    <script src="../js/crypto-demos/hash-core.js"></script>
    <script src="../js/crypto-demos/hash-demo.js"></script>
</body>
</html>
